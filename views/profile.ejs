<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/styles.css">
  
</head>
<body>
  <header>
    <div class="container">
      <h1 class="logo">Фанаты и точка</h1>
      <nav>
        <ul>
          <li><a href="/">Главная</a></li>
          <li><a href="/explore">Изучить</a></li>
          <li><a href="/messages">Мессенджер</a></li>
          <% if (!user) { %> <!-- Если пользователь не авторизован -->
            <li><a href="/login">Войти</a></li>
            <li><a href="/register">Регистрация</a></li>
          <% } else { %> <!-- Если пользователь авторизован -->
            <li><a href="/profile">Профиль</a></li>
            <li><a href="/logout">Выйти</a></li>
          <% } %>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="profile">
        <h2>Профиль пользователя</h2>
        <div class="profile-info">
          <img src="/uploads/<%= user.profilePicture.split('/').pop() %>" alt="User Avatar" class="profile-avatar">



          <div>
            <h3><%= user.profileName || 'Имя пользователя отсутствует' %></h3>
            <p><%= user.Description || 'Описание отсутствует' %></p>



            <!-- Кнопка для редактирования профиля -->
            <button class="edit-profile" onclick="toggleEditForm()">Редактировать профиль</button>

            <!-- Форма редактирования профиля (скрыта по умолчанию) -->
            <div id="editProfileForm" style="display:none;">
              <form action="/profile/edit" method="POST" enctype="multipart/form-data">
                <label for="profileName">Имя пользователя:</label>
                <input type="text" id="profileName" name="profileName" value="<%= user.profileName %>" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" value="<%= user.email %>" required>

                <label for="description">Описание:</label>
                <textarea id="description" name="description"><%= user.Description || 'Не указано' %></textarea>


                <label for="profilePicture">Фотография профиля:</label>
                <input type="file" id="profilePicture" name="profilePicture">

                <button type="submit">Сохранить изменения</button>
              </form>
            </div>

          </div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2024 Фанаты и точка. Все права защищены.</p>
    </div>
  </footer>

  <script>
    function toggleEditForm() {
      var form = document.getElementById('editProfileForm');
      form.style.display = (form.style.display === 'none' || form.style.display === '') ? 'block' : 'none';
    }

    function previewProfilePicture(event) {
      var preview = document.getElementById('profilePicturePreview');
      var file = event.target.files[0];
      var reader = new FileReader();

      reader.onload = function(e) {
        preview.src = e.target.result;
      };

      if (file) {
        reader.readAsDataURL(file);
      }
    }
  </script>
</body>
</html>
